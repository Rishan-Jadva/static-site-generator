<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>(Day 3) - Advent of Cyber</title>
    <link href="/static-site-generator/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>(Day 3) - Advent of Cyber</h1><p>Target IP - 10.10.153.110</p><h2>ELK Logs</h2><p>Upon instruction from TryHackMe, we were told to narrow down our search from October 3rd 11:30am to October 3 12pm. Here we see the logs:</p><p><img src="/static-site-generator/images/Pasted image 20241204114458.png" alt="Pasted image 20241204114458.png"></img></p><p>Here we have many logs to look through, let's see if we can reduce the number of logs to sift through. Considering the proof of concept used by TryHackMe in the example, we see that the attacker uploaded a shell.php. We will search for this message using KLQ:</p><p><img src="/static-site-generator/images/Pasted image 20241204114648.png" alt="Pasted image 20241204114648.png"></img></p><p>Nice, we have now narrowed our search down to 13 hits, a lot less to sift through. Here we see that the location where our file is uploaded to is:</p><p><img src="/static-site-generator/images/Pasted image 20241204115347.png" alt="Pasted image 20241204115347.png"></img></p><p>When we try to move to that location we cannot see anything so we will need to find out what Glitch did to get this shell uploaded:</p><p><img src="/static-site-generator/images/Pasted image 20241204115812.png" alt="Pasted image 20241204115812.png"></img></p><p>Here we see the IP address that was mostly used for each of the shell.php requests, now we can also see that Glitch seems to have admin access as seen here:</p><p><img src="/static-site-generator/images/Pasted image 20241204120018.png" alt="Pasted image 20241204120018.png"></img></p><p>So we need to find a way to login to the site as admin, we will go to the website and attempt to login using admin admin credentials:</p><p><img src="/static-site-generator/images/Pasted image 20241204120224.png" alt="Pasted image 20241204120224.png"></img></p><p>Here we see that we need to enter an email, so we cannot just use admin as the email section of the login. However, we previously saw in the TryHackMe, some common usernames that may be used and one of which was in the format of an email:</p><p><img src="/static-site-generator/images/Pasted image 20241204120403.png" alt="Pasted image 20241204120403.png"></img></p><p>So if we were to use the domain name frostypines.thm with the admin account we can try to login like below with password admin:</p><p><img src="/static-site-generator/images/Pasted image 20241204120514.png" alt="Pasted image 20241204120514.png"></img></p><p>Success, we have access to the admin account:</p><p><img src="/static-site-generator/images/Pasted image 20241204120549.png" alt="Pasted image 20241204120549.png"></img></p><p>Now moving to the /admin endpoint we see a dashboard:</p><p><img src="/static-site-generator/images/Pasted image 20241204120701.png" alt="Pasted image 20241204120701.png"></img></p><p>By clicking on Add new Room we see that there is an area to add an image for the room which may result in a file inclusion vulnerability:</p><p><img src="/static-site-generator/images/Pasted image 20241204121246.png" alt="Pasted image 20241204121246.png"></img></p><p>We will now upload a webshell.php that we found online:</p><p><img src="/static-site-generator/images/Pasted image 20241204121413.png" alt="Pasted image 20241204121413.png"></img></p><p>We will now upload the shell.php file and move to this directory:</p><p><img src="/static-site-generator/images/Pasted image 20241204121946.png" alt="Pasted image 20241204121946.png"></img></p><p>Just like in the logs.</p><p>Here we receive the webshell:</p><p><img src="/static-site-generator/images/Pasted image 20241204122015.png" alt="Pasted image 20241204122015.png"></img></p><p>From here we can find the file to complete the room:</p><p><img src="/static-site-generator/images/Pasted image 20241204122102.png" alt="Pasted image 20241204122102.png"></img></p></div></article>
    <a href="/static-site-generator">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>