<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>(Day 20) - Advent of Cyber</title>
    <link href="/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>(Day 20) - Advent of Cyber</h1><h2>Wireshark Packet Analysis</h2><p>The first step in analysing the packets is to filter the packets that are related to Marta May Ware's ip address, we will do this by using the following filter:</p><p><img src="/images/Pasted image 20241231142447.png" alt="Pasted image 20241231142447.png"></img></p><p>We additionally filter using http because this can be used to identify plaintext communication between the attacker and the webserver. Given that we know about a Command & Control server we see the following packets:</p><p><img src="/images/Pasted image 20241231142723.png" alt="Pasted image 20241231142723.png"></img></p><p>So now our first task indicates that we want to know the first message sent to Mayor Malware's C2. To do this we will right click the first HTTP POST request /initial and click follow tcp stream. There we are able to see the messages sent to the C2 here:</p><p><img src="/images/Pasted image 20241231143131.png" alt="Pasted image 20241231143131.png"></img></p><p>The red message was the first message which is <code>I am in Mayor!</code>. Looking at the first packet there we can see the ip address that indicates the C2 server here:</p><p><img src="/images/Pasted image 20241231143552.png" alt="Pasted image 20241231143552.png"></img></p><p>Since the IP address 10.10.229.217 was Marta May Ware's IP address we can deduce that the destination IP address is also the IP address of the C2 server.</p><p>Now to find out the commands that the attacker sends to the target machine we can right click the HTTP GET request in relation to the /command endpoint and follow the TCP stream and there we see that the command that was sent was:</p><p><img src="/images/Pasted image 20241231144208.png" alt="Pasted image 20241231144208.png"></img></p><p>The next step is to find out the name of the file that was exfiltrated. In order to do this we can once again see check the HTTP requests and there we see the endpoint /exfiltrate.</p><p><img src="/images/Pasted image 20241231145033.png" alt="Pasted image 20241231145033.png"></img></p><p>Now repeating the same step as before, following the tcp stream, we see the following filename:</p><p><img src="/images/Pasted image 20241231145139.png" alt="Pasted image 20241231145139.png"></img></p><p>Here we see: - Filename: <code>credentials.txt</code> - Encryption key: <code>1234567890abcdef1234567890abcdef</code></p><p>Now in order to find the secret message we will check the beacons tcp stream. Here we see the first HTTP POST request related to the beacon.</p><p><img src="/images/Pasted image 20241231150029.png" alt="Pasted image 20241231150029.png"></img></p><p>Now we will head on to cyberchef and decrypt the following encrypted string using the above key using the possible aes ecd decrypt.</p><p><img src="/images/Pasted image 20241231151719.png" alt="Pasted image 20241231151719.png"></img></p></div></article>
    <a href="/">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>