<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>THM - Mountaineer</title>
    <link href="/static-site-generator/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>THM - Mountaineer</h1><p>Target IP - 10.10.183.84</p><h2>Enumeration</h2><h4>Open Ports</h4><ul><li>Port 22 - SSH</li><li>Port 80 - HTTP</li></ul><h4>Nmap Scan</h4><p><img src="/static-site-generator/images/Pasted image 20241203164353.png" alt="Pasted image 20241203164353.png"></img></p><h2>Website</h2><p>We are welcomed with a nginx server page. Due to the fact that nothing is present here, we will enumerate the rest of the pages with gobuster.</p><p><img src="/static-site-generator/images/Pasted image 20241203164421.png" alt="Pasted image 20241203164421.png"></img></p><h4>Gobuster</h4><p><img src="/static-site-generator/images/Pasted image 20241203164554.png" alt="Pasted image 20241203164554.png"></img></p><p>Here we find a /wordpress endpoint, by travelling to this domain we find a wordpress website.</p><p><img src="/static-site-generator/images/Pasted image 20241203165048.png" alt="Pasted image 20241203165048.png"></img></p><p>We will now run gobuster again to see if we can enumerate any wordpress related enpoints:</p><p><img src="/static-site-generator/images/Pasted image 20241203165605.png" alt="Pasted image 20241203165605.png"></img></p><p>There we find the admin page for wordpress and by attempting to login using the username admin, we find this message:</p><p><img src="/static-site-generator/images/Pasted image 20241203165810.png" alt="Pasted image 20241203165810.png"></img></p><p>So now we can use hydra to attempt to crack the password for the site.  However, after a long time of trying to crack the password, there didn't seem to be much so we started wpscan. We found a few vulnerabilites but after attempting to use them, we seem to get some password hashes but cannot crack them.</p><p>Maybe we will try and exploit any misconfigurations of the server rather than premade exploits.</p><p><img src="/static-site-generator/images/Pasted image 20241203174622.png" alt="Pasted image 20241203174622.png"></img></p><p>Here we have a vulnerability in the local files of the web server. We also find a VHOST here:</p><p><img src="/static-site-generator/images/Pasted image 20241203174735.png" alt="Pasted image 20241203174735.png"></img></p><p>Adding it to our /etc/hosts we receive this website:</p><p><img src="/static-site-generator/images/Pasted image 20241203175115.png" alt="Pasted image 20241203175115.png"></img></p><p>Running wpscan for the original website and enumerating the users, we are able to find five usernames that should work:</p><ul><li>chooyu</li><li>everest</li><li>montblanc</li><li>admin</li><li>k2</li></ul><p>We will first attempt to use the username as the password for each of the usernames:</p><p><img src="/static-site-generator/images/Pasted image 20241203181638.png" alt="Pasted image 20241203181638.png"></img></p><p>We found the user k2 with the password k2 as a successful login. Now we will check the website for any good information we can use to login as a shell.</p><p><img src="/static-site-generator/images/Pasted image 20241203181942.png" alt="Pasted image 20241203181942.png"></img></p><p>Here we are able to find a password, we can attempt to login to wordpress using this password. Now we have successfully logged in as k2 using the above password.</p><p><img src="/static-site-generator/images/Pasted image 20241203182611.png" alt="Pasted image 20241203182611.png"></img></p><p>Now we have the wordpress version 6.4.3, looking online we find many vulnerabilities include a Remote Code Execution (RCE) vulnerability in CVE-2021-24145.</p><h2>Exploit</h2><p><img src="/static-site-generator/images/Pasted image 20241203183101.png" alt="Pasted image 20241203183101.png"></img></p><p>After running the exploit, we go to the link and we receive a web shell, however, we prefer to have a better shell so we will run a reverse shell payload on the shell to our local computer:</p><p><img src="/static-site-generator/images/Pasted image 20241203183405.png" alt="Pasted image 20241203183405.png"></img></p><p><img src="/static-site-generator/images/Pasted image 20241203183414.png" alt="Pasted image 20241203183414.png"></img></p><p>We will now upgrade our shell then continue with privilege escalation.</p><p><img src="/static-site-generator/images/Pasted image 20241203183531.png" alt="Pasted image 20241203183531.png"></img></p><h2>Privilege Escalation</h2><p>We can now upgrade our privilege by changing switching user to k2 by using the password we used to get into the roundcube mail server (k2).</p><p><img src="/static-site-generator/images/Pasted image 20241203183825.png" alt="Pasted image 20241203183825.png"></img></p><p>In the home directory for k2 we find the sent mail for the user k2 to lhotse:</p><p><img src="/static-site-generator/images/Pasted image 20241203184047.png" alt="Pasted image 20241203184047.png"></img></p><p>This is interesting but we will come back to that later if needed, we also see that we can access lhotse's home directory so we will move in there and see what is there:</p><p><img src="/static-site-generator/images/Pasted image 20241203184226.png" alt="Pasted image 20241203184226.png"></img></p><p>Here we find a KeePass file and we will transfer it to our attacker machine by changing it to base64 and copying the data then decoding it on our attacker machine. Now we will create a custom wordlist using cupp:</p><p><img src="/static-site-generator/images/Pasted image 20241203184912.png" alt="Pasted image 20241203184912.png"></img></p><p>Now we will use john and the wordlist to try and crack the keepass:</p><p><img src="/static-site-generator/images/Pasted image 20241203185019.png" alt="Pasted image 20241203185019.png"></img></p><p>And now we have found the password for keepass, we will now open the file using the password and look what we have found:</p><p><img src="/static-site-generator/images/Pasted image 20241203185600.png" alt="Pasted image 20241203185600.png"></img></p><p>We are able to get the password for the kangchenjunga user, within their home directory we find the local.txt file and a non-empty .bash<i>history file: in the file we can see a failed attempt at changing user to root then the user wrote the root user's password in plain text.</i></p><p><img src="/static-site-generator/images/Pasted image 20241203185813.png" alt="Pasted image 20241203185813.png"></img></p><p>Now we can move to become the root user:</p><p><img src="/static-site-generator/images/Pasted image 20241203185853.png" alt="Pasted image 20241203185853.png"></img></p><p>Moving to the home directory for root, we are able to get the root.txt:</p><p><img src="/static-site-generator/images/Pasted image 20241203190015.png" alt="Pasted image 20241203190015.png"></img></p></div></article>
    <a href="/static-site-generator">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>