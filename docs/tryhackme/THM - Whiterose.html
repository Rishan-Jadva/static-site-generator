<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>THM - Whiterose</title>
    <link href="static-site-generator/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>THM - Whiterose</h1><p>Target IP - 10.10.102.155</p><h2>Enumeration</h2><h4>Open Ports</h4><ul><li>Port 22 - SSH</li><li>Port 80 - HTTP</li></ul><h4>Nmap Scan</h4><p><img src="/images/Pasted image 20241201185332.png" alt="Pasted image 20241201185332.png"></img></p><h2>Website</h2><p>Add cyprusbank.thm to /etc/hosts. We see a website that is under maintenance which does not have anything hidden that we can see.</p><p><img src="/images/Pasted image 20241201185141.png" alt="Pasted image 20241201185141.png"></img></p><h4>Gobuster</h4><p>Does not seem to be anything yet but we will check back on it.</p><p><img src="/images/Pasted image 20241201185715.png" alt="Pasted image 20241201185715.png"></img></p><h4>ffuf</h4><p>Using ffuf we will enumerate the possible subdomains of the website.</p><p><img src="/images/Pasted image 20241201190536.png" alt="Pasted image 20241201190536.png"></img></p><p>Here we have found the admin subdomain. We will add it to our /etc/hosts then check website at that subdomain.</p><p><img src="/images/Pasted image 20241201190723.png" alt="Pasted image 20241201190723.png"></img></p><p>Now we have found a login page, we can use the credentials that we were given and login to this page.</p><p><img src="/images/Pasted image 20241201190850.png" alt="Pasted image 20241201190850.png"></img></p><p>Now we are given a list of transactions with different peoples names and balances. Moving through the directories we come across an admin chat, there may be an Insecure Direct Object Reference (IDOR) Vulnerability because of the url being structured like this:</p><p><img src="/images/Pasted image 20241201191616.png" alt="Pasted image 20241201191616.png"></img></p><p>By changing the value from 5 to 0 we are able to find some secret chats containing a password for another user Gayle:</p><p><img src="/images/Pasted image 20241201191743.png" alt="Pasted image 20241201191743.png"></img></p><p>We will first try and login as Gayle through the website before we try logging in using SSH:</p><p><img src="/images/Pasted image 20241201191930.png" alt="Pasted image 20241201191930.png"></img></p><p>Now we are able to login and see all the private credentials of all the users as well as access the settings that we couldn't as user olivia:</p><p><img src="/images/Pasted image 20241201192022.png" alt="Pasted image 20241201192022.png"></img></p><p>In the settings page we find that we are able to change the password for any user. By testing it out with some data we see that there might be a cross-site scripting (XSS) vulnerability:</p><p><img src="/images/Pasted image 20241201192227.png" alt="Pasted image 20241201192227.png"></img></p><p>It seems to use the user input to output text onto the screen. We will test for any vulnerabilities by capturing the request in BurpSuite. By removing the password from the POST request, we seem to find an error and it also gives us some files that we can search for vulnerabilities for:</p><p><img src="/images/Pasted image 20241201193046.png" alt="Pasted image 20241201193046.png"></img></p><p>Here we have found ejs, by looking up ejs vulnerabilities we find that there seems to be a Server-Side Template Injection (SSTI) vulnerability for ejs. By looking at the PoC's and exploits we are able to use them to attempt to exploit the web application.</p><p><img src="/images/Pasted image 20241201194106.png" alt="Pasted image 20241201194106.png"></img></p><p>Now we were able to receive a web shell:</p><p><img src="/images/Pasted image 20241201194146.png" alt="Pasted image 20241201194146.png"></img></p><p>We will check what sudo commands we can run as web:</p><p><img src="/images/Pasted image 20241201194758.png" alt="Pasted image 20241201194758.png"></img></p><p>Checking the version of sudoedit and searching online for vulnerabilities we find that there it is a vulnerable version that can lead to privilege escalation under CVE-2023-22809:</p><p><img src="/images/Pasted image 20241201202609.png" alt="Pasted image 20241201202609.png"></img></p></div></article>
    <a href="/">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>