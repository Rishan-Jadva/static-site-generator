<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>THM - Biohazard</title>
    <link href="/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>THM - Biohazard</h1><p>Target IP: 10.10.190.138</p><h2>Enumeration</h2><h3>Open Ports</h3><ul><li>Port 21 - FTP</li><li>Port 22 - SSH</li><li>Port 80 - HTTP</li></ul><h3>Enumerating the Web Server</h3><p>Upon accessing the website, we are given the base site</p><p><img src="/images/Pasted image 20241128164656.png" alt="Pasted image 20241128164656.png"></img></p><p>We then click the link and are given this site</p><p><img src="/images/Pasted image 20241128164754.png" alt="Pasted image 20241128164754.png"></img></p><p>In the source code we find:</p><p><img src="/images/Pasted image 20241128164824.png" alt="Pasted image 20241128164824.png"></img></p><p>Upon accessing this page we find:</p><p><img src="/images/Pasted image 20241128164914.png" alt="Pasted image 20241128164914.png"></img></p><p>By clicking the link we find an emblem:</p><p><img src="/images/Pasted image 20241128165102.png" alt="Pasted image 20241128165102.png"></img></p><p>After looking in the source code for the dining room we find a base64 encoded string:</p><p><img src="/images/Pasted image 20241128165243.png" alt="Pasted image 20241128165243.png"></img></p><p>After decoding the string we obtain:</p><p><img src="/images/Pasted image 20241128165337.png" alt="Pasted image 20241128165337.png"></img></p><p>By travelling to this page, this is what we get:</p><p><img src="/images/Pasted image 20241128165454.png" alt="Pasted image 20241128165454.png"></img></p><p>By clicking the link we receive the lockpick flag:</p><p><img src="/images/Pasted image 20241128165544.png" alt="Pasted image 20241128165544.png"></img></p><p>The page suggests that we visit the art Room, upon visiting the page we see:</p><p><img src="/images/Pasted image 20241128165657.png" alt="Pasted image 20241128165657.png"></img></p><p>We are given a link to click after clicking it we are given a map of the website:</p><p><img src="/images/Pasted image 20241128165748.png" alt="Pasted image 20241128165748.png"></img></p><p>We begin to go to each new room, by going to the barRoom we discover the fact we need to use a lockpick we obtained earlier.</p><p><img src="/images/Pasted image 20241128170309.png" alt="Pasted image 20241128170309.png"></img></p><p>Upon entering the lockpick we enter the bar room:</p><p><img src="/images/Pasted image 20241128170359.png" alt="Pasted image 20241128170359.png"></img></p><p>There is a link to read moonlight somata, clicking this link we go a page with a code:</p><p><img src="/images/Pasted image 20241128170653.png" alt="Pasted image 20241128170653.png"></img></p><p>This is a base32 string when converted we receive:</p><p><img src="/images/Pasted image 20241128170753.png" alt="Pasted image 20241128170753.png"></img></p><p>Upon entering this sheet in the bar room we enter this page:</p><p><img src="/images/Pasted image 20241128170905.png" alt="Pasted image 20241128170905.png"></img></p><p>There is a link, once clicked we receive the emblem:</p><p><img src="/images/Pasted image 20241128171042.png" alt="Pasted image 20241128171042.png"></img></p><p>We are instructed to place this in an emblem slot on a previous page, we discover that by placing this emblem in the dining room we receive a code:</p><p><img src="/images/Pasted image 20241128171236.png" alt="Pasted image 20241128171236.png"></img></p><p>I believe this is a vignere cipher but I do not know the key. I refresh the secret bar page and place the original emblem in the slot that the gold emblem used to be, there we receive a name:</p><p><img src="/images/Pasted image 20241128174113.png" alt="Pasted image 20241128174113.png"></img></p><p>I believe this is the vignere cipher's key upon entering it into the decoder we find this:</p><p><img src="/images/Pasted image 20241128174309.png" alt="Pasted image 20241128174309.png"></img></p><p>By going to the page (/diningRoom/the<i>great</i>shield<i>key.html) we find this:</i></p><p><img src="/images/Pasted image 20241128174553.png" alt="Pasted image 20241128174553.png"></img></p><p>We then go to two different rooms starting with the armor room where a shield symbol is embedded into the door:</p><p><img src="/images/Pasted image 20241128174714.png" alt="Pasted image 20241128174714.png"></img></p><p>Upon entering the shield<i>key we get:</i></p><p><img src="/images/Pasted image 20241128174751.png" alt="Pasted image 20241128174751.png"></img></p><p>Upon clicking the link we get:</p><p><img src="/images/Pasted image 20241128174845.png" alt="Pasted image 20241128174845.png"></img></p><p>This is one part of a multipart cipher. We will continue to the next room before decoding the crests. We will go to the attic:</p><p><img src="/images/Pasted image 20241128174949.png" alt="Pasted image 20241128174949.png"></img></p><p>Entering the shield<i>key we get:</i></p><p><img src="/images/Pasted image 20241128175025.png" alt="Pasted image 20241128175025.png"></img></p><p>Reading the note we get:</p><p><img src="/images/Pasted image 20241128175051.png" alt="Pasted image 20241128175051.png"></img></p><p>There seems to be two more crests we will go back to the rooms we missed on the map, we will first head to the DiningRoom2F, here we find:</p><p><img src="/images/Pasted image 20241128175533.png" alt="Pasted image 20241128175533.png"></img></p><p>Checking the source code we find some encrypted text:</p><p><img src="/images/Pasted image 20241128175630.png" alt="Pasted image 20241128175630.png"></img></p><p>This encrypted text is encoded using ROT13 by decrypting we receive:</p><p><img src="/images/Pasted image 20241128180450.png" alt="Pasted image 20241128180450.png"></img></p><p>Going it the link we receive:</p><p><img src="/images/Pasted image 20241128180530.png" alt="Pasted image 20241128180530.png"></img></p><p>We then go to the tiger status room:</p><p><img src="/images/Pasted image 20241128180623.png" alt="Pasted image 20241128180623.png"></img></p><p>Placing the gem into the tiger's eye we get:</p><p><img src="/images/Pasted image 20241128180700.png" alt="Pasted image 20241128180700.png"></img></p><p>Looking in the gallery Room we find:</p><p><img src="/images/Pasted image 20241128181404.png" alt="Pasted image 20241128181404.png"></img></p><p>Following the link, we find the final crest:</p><p><img src="/images/Pasted image 20241128181429.png" alt="Pasted image 20241128181429.png"></img></p><p>By decoding all of the crests we get:</p><p><img src="/images/Pasted image 20241128181615.png" alt="Pasted image 20241128181615.png"></img></p><p><img src="/images/Pasted image 20241128181631.png" alt="Pasted image 20241128181631.png"></img></p><p><img src="/images/Pasted image 20241128181649.png" alt="Pasted image 20241128181649.png"></img></p><p><img src="/images/Pasted image 20241128181703.png" alt="Pasted image 20241128181703.png"></img></p><p>By putting them together and decoding we get:</p><p><img src="/images/Pasted image 20241128181801.png" alt="Pasted image 20241128181801.png"></img></p><h3>Enumerating FTP</h3><p>Upon entering the FTP given the above credentials we see these files:</p><p><img src="/images/Pasted image 20241128182205.png" alt="Pasted image 20241128182205.png"></img></p><p>Once we get all of the files from FTP we can analyse each one. We will start with seeing what important.txt says:</p><p><img src="/images/Pasted image 20241128182310.png" alt="Pasted image 20241128182310.png"></img></p><p>There seems to be a /hidden<i>closet/ webpage but it also needs the helmet</i>key.</p><p>Now looking at the three keys we were given, there doesn't seem to be anything visually worth looking at but we will first check using steghide to see if there are any hidden files located within the image. Upon doing this we saw only one of the files had a hidden file in which we extracted.</p><p><img src="/images/Pasted image 20241128184509.png" alt="Pasted image 20241128184509.png"></img></p><p>Now we will check exiftool to see if there is any important information given in the keys. Given that we already found a key in key-001 we will skip that file.</p><p><img src="/images/Pasted image 20241128184650.png" alt="Pasted image 20241128184650.png"></img></p><p>We find a comment with some text which we will extract to a new file. Now we will use binwalk to check if there is anything extra in addition to the image information.</p><p><img src="/images/Pasted image 20241128184820.png" alt="Pasted image 20241128184820.png"></img></p><p>We see there is a zip in this image so we will unzip it cat there should be some text information.</p><p><img src="/images/Pasted image 20241128184904.png" alt="Pasted image 20241128184904.png"></img></p><p>Adding all three keys together then decrypting using base64 we get:</p><p><img src="/images/Pasted image 20241128185453.png" alt="Pasted image 20241128185453.png"></img></p><p>After decrypting the helmet<i>key file with gpg we receive:</i></p><p><img src="/images/Pasted image 20241128185552.png" alt="Pasted image 20241128185552.png"></img></p><p>Now going back to the closet room we can now enter the helmet<i>key:</i></p><p><img src="/images/Pasted image 20241128185711.png" alt="Pasted image 20241128185711.png"></img></p><p>In the Study Room we have a link which gives us a file called doom.tar.gz. Before we extract the file we will first check what is in the closet room:</p><p><img src="/images/Pasted image 20241128185849.png" alt="Pasted image 20241128185849.png"></img></p><p>Here we have two links, once clicked we get:</p><p><img src="/images/Pasted image 20241128185929.png" alt="Pasted image 20241128185929.png"></img></p><p>And:</p><p><img src="/images/Pasted image 20241128185945.png" alt="Pasted image 20241128185945.png"></img></p><p>The above text looks like a vignere cipher, so we may need to look at the doom.tar.gz file first.</p><p><img src="/images/Pasted image 20241128190206.png" alt="Pasted image 20241128190206.png"></img></p><p>Now we have all of the ssh information we need but we also have the cipher to keep in mind. Now let's use ssh to connect to the server.</p><p><img src="/images/Pasted image 20241128190444.png" alt="Pasted image 20241128190444.png"></img></p><p>Now we will check the files and directories we can access:</p><p><img src="/images/Pasted image 20241128190633.png" alt="Pasted image 20241128190633.png"></img></p><p>There seems to be nothing there but we will list all of the files and directories using:</p><p><img src="/images/Pasted image 20241128190701.png" alt="Pasted image 20241128190701.png"></img></p><p>There is and interesting directory called .jailcell. Upon entering this we see some interesting information regarding chris.</p><p><img src="/images/Pasted image 20241128190953.png" alt="Pasted image 20241128190953.png"></img></p><p>Now we have another name 'albert'. Now what if we use this name as the key for the vignere cipher that we found previously.</p><p><img src="/images/Pasted image 20241128191611.png" alt="Pasted image 20241128191611.png"></img></p><p>We now have the login for weasker, so lets ssh into weasker.</p><p><img src="/images/Pasted image 20241128191734.png" alt="Pasted image 20241128191734.png"></img></p><p>We have also found some interesting information. Now we with run sudo -l and we see that we can run any command with root.</p><p><img src="/images/Pasted image 20241128192053.png" alt="Pasted image 20241128192053.png"></img></p><p>Now we will move into the root directory and find the root.txt.</p><p><img src="/images/Pasted image 20241128192227.png" alt="Pasted image 20241128192227.png"></img></p></div></article>
    <a href="/">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>