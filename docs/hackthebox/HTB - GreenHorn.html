<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HTB - GreenHorn</title>
    <link href="static-site-generator/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>HTB - GreenHorn</h1><p>Target IP - 10.10.11.25</p><h2>Enumeration</h2><h4>Open Ports</h4><ul><li>Port 22 - SSH</li><li>Port 80 - HTTP</li><li>Port 3000 - ppp?</li></ul><h4>Nmap</h4><p><img src="/images/Pasted image 20241215230400.png" alt="Pasted image 20241215230400.png"></img></p><h2>Website</h2><p>We first need to add greenhorn.htb to our /etc/hosts. Then we are presented with:</p><p><img src="/images/Pasted image 20241215230525.png" alt="Pasted image 20241215230525.png"></img></p><p>We also are able to identify that the CMS for this application is pluck, by clicking on admin at the bottom of the page we are greeted with an admin login page which tells us the version of the application.</p><p><img src="/images/Pasted image 20241215230758.png" alt="Pasted image 20241215230758.png"></img></p><p>By also opening the http page on port 3000, we see a Gitea instance, which seems to contain the source code for the application:</p><p><img src="/images/Pasted image 20241215231358.png" alt="Pasted image 20241215231358.png"></img></p><p>By looking through all the files, we see the location of the password:</p><p><img src="/images/Pasted image 20241215231442.png" alt="Pasted image 20241215231442.png"></img></p><p>By analysing this hash in hash analyser, we see that this is a sha2-512 hash:</p><p><img src="/images/Pasted image 20241215231923.png" alt="Pasted image 20241215231923.png"></img></p><p>Then using crackstation, we can crack the hash and receive the password for the user:</p><p><img src="/images/Pasted image 20241215232049.png" alt="Pasted image 20241215232049.png"></img></p><h2>Exploit</h2><p>Logging in we see the admin page for the pluck CMS application:</p><p><img src="/images/Pasted image 20241216001841.png" alt="Pasted image 20241216001841.png"></img></p><p>We see we can upload a module here:</p><p><img src="/images/Pasted image 20241216002015.png" alt="Pasted image 20241216002015.png"></img></p><p>We will upload a php reverse shell to the website and then receive the webshell, attempting to get a reverse shell by uploading a .php file does not work, this is because modules must be in a zip format or similar.</p><p><img src="/images/Pasted image 20241216002125.png" alt="Pasted image 20241216002125.png"></img></p><p>After successfully uploading the zip file, we will move to the directory that contains the module under the endpoint /data/modules/(zip<i>name)/(reverse-shell</i>name). Before moving to the endpoint, make sure the netcat listener is active.</p><p><img src="/images/Pasted image 20241216002808.png" alt="Pasted image 20241216002808.png"></img></p><p>We will now upgrade out shell to bash and make it interactive.</p><p><img src="/images/Pasted image 20241216003657.png" alt="Pasted image 20241216003657.png"></img></p><h2>Privilege Escalation</h2><p>Heading to home files, we see that there is a user junior, we can attempt to reuse the password that we used to login to the pluck web application here, incase they reuse the password.</p><p><img src="/images/Pasted image 20241216003837.png" alt="Pasted image 20241216003837.png"></img></p><p>Success now we are able to read user.txt:</p><p><img src="/images/Pasted image 20241216003906.png" alt="Pasted image 20241216003906.png"></img></p><p>Additionally, Junior's home directory also includes a pdf file that has instruction on how to use OpenVAS. Opening the file we see:</p><p><img src="/images/Pasted image 20241216004816.png" alt="Pasted image 20241216004816.png"></img></p><p>Looking at the password, we have a pixelated obfuscated password, by searching online we find a Depix software here: https://github.com/spipm/Depix.git</p><p>After running the software we obtain this image:</p><p><img src="/images/Pasted image 20241216010136.png" alt="Pasted image 20241216010136.png"></img></p><p>After attempting to upgrade to root, we see that the password is correct:</p><p><img src="/images/Pasted image 20241216010442.png" alt="Pasted image 20241216010442.png"></img></p><p>Thereafter, heading to root's home we receive this root.txt:</p><p><img src="/images/Pasted image 20241216010516.png" alt="Pasted image 20241216010516.png"></img></p></div></article>
    <a href="/">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>