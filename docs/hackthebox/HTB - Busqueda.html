<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>HTB - Busqueda</title>
    <link href="/static-site-generator/index.css" rel="stylesheet" />
  </head>

  <body>
    <article><div><h1>HTB - Busqueda</h1><p>Target IP - 10.10.11.208</p><h2>Enumeration</h2><h4>Open Ports</h4><ul><li>Port 22 - SSH</li><li>Port 80 - HTTP</li></ul><h4>Nmap</h4><p><img src="/images/Pasted image 20241129212539.png" alt="Pasted image 20241129212539.png"></img></p><h2>Website</h2><p>First I need to add the website to /etc/hosts. Now we should be able to access the website.</p><p><img src="/images/Pasted image 20241129212726.png" alt="Pasted image 20241129212726.png"></img></p><p>After seeing this page I saw a software with a version number:</p><p><img src="/images/Pasted image 20241129212842.png" alt="Pasted image 20241129212842.png"></img></p><p>After looking online it seems that this software is vulnerable to Arbitrary CMD Injection under CVE-2023-43364. Now I will run the exploit and we should be able to obtain a reverse shell.</p><p><img src="/images/Pasted image 20241129213321.png" alt="Pasted image 20241129213321.png"></img></p><p><img src="/images/Pasted image 20241129213333.png" alt="Pasted image 20241129213333.png"></img></p><p>Now we will upgrade the shell.</p><p><img src="/images/Pasted image 20241129213551.png" alt="Pasted image 20241129213551.png"></img></p><p>After obtaining a shell as svc we are able to obtain the user.txt.</p><h2>Privilege Escalation</h2><p>We will being with uploading linPEAS to the target machine to determine any location that can be used for privilege escalation.</p><p>Looking through we find an interesting file in the web app '.git'. Heading into the config file we find a link in relation to another application with credentials for the cody user which seems to also be the svc user. So now we can ssh into svc using these credentials and get a more stable shell.</p><p><img src="/images/Pasted image 20241130010854.png" alt="Pasted image 20241130010854.png"></img></p><p>Heading to the website and logging in as cody, we find this application:</p><p><img src="/images/Pasted image 20241130011130.png" alt="Pasted image 20241130011130.png"></img></p><p>Checking the version number, there is no known exploits, so we will try to find something within this application that we can use to escalate our privileges.</p><p>After trying to find some bad commit or anything, there seems to be nothing except for the ability to login as administrator if I can find the password elsewhere.</p><p>Let's move back to the ssh session, I found that the user svc can run a command as root:</p><p><img src="/images/Pasted image 20241130011911.png" alt="Pasted image 20241130011911.png"></img></p><p>Moving to this python script we find out that we cannot read or edit this file:</p><p><img src="/images/Pasted image 20241130012146.png" alt="Pasted image 20241130012146.png"></img></p><p>However, let's try and execute this script and see if we are able to exploit it:</p><p><img src="/images/Pasted image 20241130012413.png" alt="Pasted image 20241130012413.png"></img></p><p>It looks like we can find out about the docker containers by running the command with docker-ps:</p><p><img src="/images/Pasted image 20241130012549.png" alt="Pasted image 20241130012549.png"></img></p><p>The commands that we are able to run seem similar to commands you can run on a regular docker container. So in terms of format, if we see the types of formats that docker accepts for the docker-inspect command.</p><p>We see that we are able to use the format '{{json .}}'. Then by piping this output to jq we are able to read the json file for the container much easier:</p><p><img src="/images/Pasted image 20241130013844.png" alt="Pasted image 20241130013844.png"></img></p><p>Here we find that there is an exposed password, trying to get root using this password does not work, so how about we try and login to the gitea web application as the administrator using this password.</p><p><img src="/images/Pasted image 20241130014401.png" alt="Pasted image 20241130014401.png"></img></p><p>Here we find a set of scripts that we were running as root on the machine. Let's look into each file to try and find an exploit.</p><p>Looking at the code for the system-checkup.py we find that the other command we couldn't run full-checkup. We see in this script, the full-checkup file that we want to run is a relative path so we may be able to write our own exploit:</p><p><img src="/images/Pasted image 20241130014856.png" alt="Pasted image 20241130014856.png"></img></p><p>Before when we ran the script, the script would not work because it could not find the full-checkup.sh script but now that we are in /opt/scripts it runs fine:</p><p><img src="/images/Pasted image 20241130015146.png" alt="Pasted image 20241130015146.png"></img></p><p>This means that we can write a script in the home directory and execute a reverse shell:</p><p><img src="/images/Pasted image 20241130015816.png" alt="Pasted image 20241130015816.png"></img></p><p>Now we are able to get root.txt.</p></div></article>
    <a href="/">Back to Home</a>
  </body>
  <hr>
  <footer>
    Made By Rishan
  </footer>
</html>